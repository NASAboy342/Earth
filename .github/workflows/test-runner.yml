name: Test Self-Hosted Runner

on:
  push:
    branches: [ main ]

jobs:
  test-runner:
    runs-on: self-hosted  # This will use your self-hosted runner
    
    steps:
    - name: ğŸƒâ€â™‚ï¸ Test Runner Connection
      shell: pwsh
      run: |
        Write-Host "ğŸ‰ Self-hosted runner is working!"
        Write-Host "ğŸ–¥ï¸  Runner OS: $($env:OS)"
        Write-Host "ğŸ—ï¸  Runner Architecture: $($env:PROCESSOR_ARCHITECTURE)"
        Write-Host "ğŸ“… Current Date: $(Get-Date)"
        Write-Host "ğŸ“ Current Directory: $(Get-Location)"
        Write-Host "ğŸ‘¤ Current User: $($env:USERNAME)"
        
    - name: ğŸ” Check Available Tools
      shell: pwsh
      run: |
        Write-Host "ğŸ› ï¸  Checking available tools..."
        try { Write-Host "Git version: $(git --version)" } catch { Write-Host "Git not found" }
        try { Write-Host "Node version: $(node --version)" } catch { Write-Host "Node not found" }
        try { Write-Host "NPM version: $(npm --version)" } catch { Write-Host "NPM not found" }
        Write-Host "PowerShell version: $($PSVersionTable.PSVersion)"
        
    - name: ğŸ§ª Test Basic Commands
      shell: pwsh
      run: |
        Write-Host "ğŸ§ª Running basic command tests..."
        Write-Host "ğŸ“Š System uptime:"
        try { Write-Host "$(Get-CimInstance -ClassName Win32_OperatingSystem | Select-Object @{Name='Uptime'; Expression={(Get-Date) - $_.LastBootUpTime}})" } catch { Write-Host "Uptime check failed" }
        Write-Host "ğŸ’¾ Disk space:"
        try { Get-CimInstance -ClassName Win32_LogicalDisk | Where-Object {$_.DriveType -eq 3} | Select-Object DeviceID, @{Name='Size(GB)'; Expression={[math]::Round($_.Size/1GB,2)}}, @{Name='FreeSpace(GB)'; Expression={[math]::Round($_.FreeSpace/1GB,2)}} } catch { Write-Host "Disk space check failed" }
        Write-Host "ğŸ” Environment variables (filtered):"
        try { Get-ChildItem env: | Where-Object {$_.Name -match "^(PATH|HOME|USER|RUNNER|COMPUTERNAME)"} | Select-Object -First 10 | Format-Table Name, Value } catch { Write-Host "Environment check failed" }
        
    - name: âœ… Test Complete
      shell: pwsh
      run: |
        Write-Host "ğŸŠ All tests completed successfully!"
        Write-Host "âœ¨ Your self-hosted runner is ready to use!"
